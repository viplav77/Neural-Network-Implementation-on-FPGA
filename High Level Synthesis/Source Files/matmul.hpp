#include "ap_int.h"

#define n_inputs 13
#define n_layer1 32
#define n_layer2 16
#define n_layer3 1

void hwmm_layer1(float input[n_inputs], const float weights[n_inputs][n_layer1], float output[1][n_layer1]);
void hw_act_layer1(float input[1][n_layer1], float output[1][n_layer1]);
void hwmm_layer2(float input[1][n_layer1], const float weights[n_layer1][n_layer2], float output[1][n_layer2]);
void hw_act_layer2(float input[1][n_layer2], float output[1][n_layer2]);
void hwmm_layer3(float input[1][n_layer2], const float weights[n_layer2][n_layer3], float output[1][n_layer3]);
void hw_act_layer3(float input[1][n_layer3], int &pred);
int nn_inference(float input_img[n_inputs]);


namespace weights{

	const float layer3_weights[n_layer2][n_layer3] = {{-1.4816353},
			{-0.3994583},
			{-1.8845209},
			{0.99111617},
			{1.0451578},
			{-1.4572523},
			{-3.39317},
			{0.9958386},
			{1.2756126},
			{-2.0774786},
			{-7.18258},
			{0.023483234},
			{-5.136366},
			{1.0964639},
			{-1.3910536},
			{-0.61480343}};

	const float layer2_weights[n_layer1][n_layer2] = {{-0.135638, -0.25781003, -0.13757175, 0.19954789, 0.05583403, -0.049965248, -0.8779099, -0.51078403, 0.02228002, 0.61005074, -0.1451369, -0.11651977, -0.18033253, -0.0076588807, -0.1581326, -0.02107267},
	{0.49109808, -0.08556765, 0.094748326, -0.97617674, -1.2084124, 0.48265356, 1.2074993, -0.4731063, 0.21839547, 0.38678896, 0.034990206, -0.0283115, 0.2725137, -1.0705166, 0.63755494, 0.41163635},
	{0.67819554, -0.3163121, 1.4090314, 1.2391728, 1.3966879, 0.16000484, -0.82668436, 1.0876151, 0.44428098, -3.4379547, -1.2279913, -0.2632302, 1.7754736, 1.1839058, 0.62953216, 0.30860585},
	{-1.6647552, -0.11328733, -5.021665, 0.24173401, 0.10613345, -2.0759087, -0.467869, 0.6415084, -0.23340756, 1.4660767, -5.420749, 0.20454453, -6.072264, 0.10041659, -1.7990665, -1.6017342},
	{0.4376922, 0.7530253, 0.51813865, 0.78714764, 1.0997139, 0.5375035, -0.68376887, -0.29874307, 0.058328237, -2.7865496, 0.40241814, 0.12410181, 0.87025714, 0.79611236, 0.84938616, 1.0584008},
	{0.012086145, 0.095965475, 0.32557595, 0.25162998, 0.52259934, 0.0237508, 0.25741354, 0.53493327, -0.42160025, 0.39881143, -0.2200866, -0.5840158, 0.27383524, 0.4650066, 0.023604713, 0.17137274},
	{0.21931776, 0.047685325, 0.21423326, 0.20173378, -0.1684186, 0.32239285, -0.26410654, -0.5842307, 0.32300153, 0.42861667, 0.065678775, 0.15965433, 0.035686653, -0.31068662, 0.251568, 0.26853412},
	{0.22232683, 0.27007335, 0.92800415, 0.92466736, 1.3469027, 0.43634927, 0.582893, 1.3908967, 0.008570105, -2.6786609, -0.2937477, -0.5340539, 0.2137637, 1.1999569, 0.19470249, 0.033650465},
	{-0.59152764, -0.18460502, 0.5534278, 0.44776925, 0.6753353, -0.24460107, -0.81991154, 0.173729, 0.19681326, -0.80286384, -2.9844544, -0.15339701, 0.5137775, 0.73810536, -0.3394719, -0.046856724},
	{-0.19770093, 0.5408469, -0.6871102, 0.36224782, -0.027800672, -0.18148383, 0.34276557, 0.008392644, -0.23892966, 0.22876634, 0.120727, -0.0004643009, -0.18295261, 0.11910772, -0.03506055, -0.02290572},
	{-0.34242573, 0.102610864, -1.1300442, 1.5163809, 1.4734566, -0.10387675, -2.1023302, 1.9096469, 0.20548224, -1.5345147, -0.6431018, -0.2913715, -0.8404556, 1.2123677, -0.1997871, -0.52259886},
	{-3.7177913, -1.325865, -2.0920208, 0.5758396, 0.3645475, -4.0548253, -0.466376, 0.7305777, -0.16036633, 1.0489014, -7.0723953, -0.18607649, -2.8722475, 0.21615012, -4.6418514, -4.212803},
	{-3.1777716, -0.96994156, -1.411323, 0.9621467, 0.53108007, -2.5688624, 0.27472728, 0.8427812, 0.2003894, 1.0768104, -3.3344502, 0.04603686, -2.0139213, 0.72754484, -2.7720695, -2.224232},
	{0.38851434, 0.07617481, 0.09010336, 0.33599567, 0.38943145, 0.37677896, -0.5866621, -0.27453795, -0.24811769, -0.074210204, 0.13586095, 0.09239586, 0.03253352, -0.06687838, 0.3377857, -0.009371986},
	{-0.51793647, -0.040827982, 0.105246745, -0.55186176, -0.7889301, -0.25815114, 0.049075823, -0.31599134, -0.075864874, 0.5907099, 0.048749767, -0.2419709, 0.14138131, -0.74576426, -0.4403602, -0.22181317},
	{0.07725755, 0.120668426, -0.2015176, 1.0298887, 1.1871656, 0.45126387, -0.011901682, 0.43723702, 0.06915742, -0.8127847, 0.85444003, -0.2452179, -0.4210214, 0.53286856, 0.33860832, 0.49328473},
	{0.19493426, -0.17047903, 0.018923007, -0.2888593, -0.23119792, 0.36360392, -0.55636996, -0.09009066, 0.40732893, -0.042937614, 0.40403998, -0.123762794, 0.13749501, -0.43876827, 0.6729966, 0.062400635},
	{0.20532447, 0.20781335, -0.31903833, 0.5169439, 0.17524402, 0.0316813, 0.13415375, -0.09580833, -0.6983794, 0.45023358, -0.09015438, -0.032690644, 0.6012616, 0.66965264, 0.23186065, -0.034392953},
	{0.60343945, 0.051182464, 0.47202376, -1.1490768, -0.7442931, 0.44504625, 0.7343844, -0.49134657, -0.22314903, 0.8739532, 0.6168993, -0.18209219, 0.28215617, -0.9750414, 0.55326325, 0.71508485},
	{-0.019616425, -0.14199848, -0.09704456, 0.27308676, 0.21410488, -0.14384052, -0.7782314, -0.23092398, -0.7024633, 0.46454555, -0.23518232, -0.36651564, 0.4889244, 0.15257663, -0.04659865, -0.057310626},
	{0.022144184, -0.36593792, 0.0465065, -0.03482588, 0.49823833, 0.28892097, -0.7353334, -0.38108966, -0.17799518, -0.2875745, -0.4655262, -0.035988387, -0.030942488, 0.55501544, 0.099992104, 0.11594162},
	{0.5527728, 0.06064042, -0.46707636, 0.46573347, 0.50117886, 0.3501335, 0.24804649, 0.3499599, 0.1989964, 0.61768025, 0.08183266, 0.016076129, -0.19085222, 0.46239588, 0.055616613, 0.149834},
	{0.61441773, -0.3554059, -0.02465801, 0.034266353, 0.43227404, -0.017162088, 0.613115, -0.25371805, -0.3055309, -0.21000099, 0.1771966, -0.19620205, -0.38659656, 0.34646928, 0.22502384, 0.24863826},
	{0.4066302, 0.4688412, 0.7605602, -0.14970948, -0.49110565, 0.38786215, 0.3387618, 0.17255004, -0.41424438, 0.2589106, -0.3536162, -0.12702678, 1.4119278, -0.587834, 0.36465585, 0.74407107},
	{0.77894616, 0.55974406, 0.39429995, -0.036207642, -0.2467542, 0.89287835, -0.042639043, -0.35019585, 0.008739729, -1.141359, 1.0794722, -0.033388216, 1.1651759, -0.3824152, 0.90409505, 0.749897},
	{-0.33120638, -0.082614265, -0.48550826, 0.3899399, 0.2672164, 0.29225808, 0.92578775, 0.46004653, 0.20069903, 0.019403357, -0.14389683, -0.3470907, -0.33966112, 0.4806798, 0.27519563, 0.2666104},
	{-0.18655106, -0.14652392, 0.25279084, 0.42748603, -0.2328679, 0.297138, -1.689792, -0.056051582, -0.17293192, -0.0058993134, -0.10993532, -0.04852095, -0.19154851, -0.010684786, -0.086678684, -0.10651878},
	{-0.49797988, -0.17431621, -0.45698, -0.34375396, -0.32295355, 0.13561614, 0.5557479, -0.25849402, -0.051206063, 0.664526, 1.1390243, -0.0463888, -0.44406015, 0.0028507705, 0.27878577, -0.042416036},
	{0.41255558, 0.27258763, 0.12471372, 0.5720735, 0.29933438, 0.28383368, -0.66739047, -0.4213781, 0.517058, -0.7919024, 0.10485991, 0.18125908, -1.0383557, 0.039231926, 0.6224656, 0.3016412},
	{-0.45823252, -0.7345123, -1.6369278, 0.5070646, 0.28924584, -0.6177647, 0.030566921, 0.6006733, 0.54127806, 0.7481082, -3.4621782, -0.3970234, -1.9508647, 0.47219014, -0.5483904, -0.25318852},
	{0.97454745, 0.03656765, 0.28859988, 0.34883046, -0.13586703, 0.91860265, -0.365496, 0.35403487, 0.33837202, -0.5712896, 0.21142198, -0.2447015, 1.0989802, 0.3566089, 0.9560608, 0.9682608},
	{1.2196274, 0.08297432, 3.3115678, 2.1244602, 2.6051462, 1.1061518, -2.6899216, 2.744337, 1.0419903, -3.995081, 4.1940207, -0.24591182, 4.026881, 2.4723642, 1.1939839, 1.0241221}};

	const float layer1_weights[n_inputs][n_layer1] = {{-0.20470402, 0.045248058, 1.1508974, -0.003423033, 0.07053651, 0.10552253, 0.05422957, 0.69974715, 0.51962775, -0.33452, 0.060156837, -0.016772985, 0.021595037, 0.25364023, 0.018794827, -1.2194657, -0.0064631, -0.026401456, 0.1510936, 0.08603357, 0.30607244, -0.21651351, -0.4008436, 0.5187181, 0.10213993, 0.35730577, 0.34783763, 0.26282507, -0.2753247, 0.012607225, -0.063752905, -1.1752497},
			{0.46870667, 0.18873364, 1.0251273, -0.03680914, -0.10537405, -0.73371977, 0.31509635, 0.7843442, 0.49907923, 0.012432416, 0.18225007, -0.02654728, 0.1075519, 0.263477, 0.34671637, -0.5840481, -0.07789515, 0.146676, 0.112746894, 0.38777646, 0.33885527, -0.30538198, -0.26860312, 0.5627354, 0.0019452381, -0.033573855, 0.5814474, 0.17127629, -0.2692518, -0.6277893, -0.16633533, -1.020842},
			{-0.0023341402, 0.00087556004, 0.013977333, 0.008216713, 0.44094908, 0.12919392, 0.06423712, -0.24612713, -0.4960493, 0.14573921, 0.03357265, 0.012200955, -0.1960502, 0.38648093, -0.09535913, 0.53260195, -0.53023, 0.33832976, 1.0895019e-06, 0.06945014, 0.054228205, 0.10884879, 0.28325826, -0.08310699, -0.31936812, -0.49067378, -0.2978809, -0.9212348, -0.056890473, 0.0514282, -0.34549898, 0.0005029059},
			{-0.41818747, 0.09427712, -0.8426534, 1.8521522, -0.5282357, 0.20265573, 0.30806723, -0.80753326, -0.18151425, 0.16258547, 0.0288045, 1.4189038, 1.7875347, -0.2260592, 0.22294983, -0.17604843, 0.22398779, 0.76576525, -0.06532235, 0.10061319, -0.5344442, 0.61530113, -0.6385498, 0.8495303, 1.1352422, 0.03855884, -0.75858974, 0.1743533, -0.68953854, 1.583051, 0.16910584, 0.47912106},
			{0.038178865, 0.085094735, 0.0283917, 0.0018729244, 0.056704376, 0.18154255, -1.0681412, 0.024135128, 0.0045552794, 0.23719804, 0.06228197, -0.023878882, 0.008506097, -0.223501, 0.00070239033, 0.27163136, -1.1415132, 0.25223202, -0.025305549, -0.1776697, 0.5238084, 0.10750841, 0.2734181, -0.105874576, 0.010379175, -0.0028199393, 0.09620678, -0.14180529, -1.326123, -0.05984645, 0.095020995, 0.016482886},
			{0.096364744, 0.013870234, 0.022919586, -0.00051173015, 0.095666006, 0.33408594, -0.3904586, -0.12981413, 0.0024561305, 0.29642716, 0.14657223, 0.006554685, -0.049196232, 0.095698334, 0.09206945, 0.018149044, 0.052814987, -0.24900696, -0.05488944, 0.208083, -0.08124947, 0.031356037, -0.46774852, 0.08234187, -0.0509932, -0.012104365, 0.04884062, 0.0800792, 0.38240543, -0.0155551685, 0.5286706, -0.012416528},
			{0.31869894, 0.041011546, 0.15214138, -0.066424504, -0.001763594, -0.43788806, 0.15206128, 0.048820492, 0.012201376, 0.49816757, 0.0030621632, -0.0017121168, 0.043211047, 0.061992366, 0.33218923, -0.13982742, -0.6881414, 0.37208512, -0.03346729, -0.2386456, 0.15295433, 0.29003966, 0.4563843, -0.0090435445, 0.018515196, -0.086037986, -0.6363258, 0.03728538, 0.4051082, -0.22254896, 0.19267528, -0.010845031},
			{0.27721158, -0.08100509, 0.027507665, 0.0034836852, 0.20211814, 0.22143342, 0.7898004, -0.047844786, -0.00014951637, 0.08808205, 0.117261, 0.004062204, 0.07917337, -0.18931594, 0.12594427, 0.0056759547, 0.27301112, -0.17307647, 0.17244048, -0.8845128, 0.04554862, -0.3130663, -0.20698877, 0.107024215, -0.06293519, 0.06337463, -0.025539707, -0.43649894, 0.31938952, -0.093194805, -0.07804339, -0.025950087},
			{0.28820962, -0.11791818, -0.07251121, 0.00091986696, -0.003788148, 0.43924314, -0.39791602, -0.055427067, 0.9503914, -0.4980995, 0.08282364, 0.0518209, -0.08256658, -0.27767763, -0.16484515, 0.16896957, 0.36706227, 0.16411772, 0.37924916, -0.68500596, -0.43352398, -0.16105206, 0.10294458, 0.076497905, 0.042311758, -0.33555925, -0.07763516, 0.4815465, 0.06336883, -0.029281018, 0.25125965, 0.009739078},
			{-0.29806763, -0.035632536, 0.07876134, -0.01538534, -0.33338773, 0.45796058, -0.21582404, 0.10485979, -0.93820935, -0.7963507, -0.02288131, 0.019528275, 0.1506449, -0.25197703, -0.08695012, -0.011630951, 0.104223885, 0.4740713, -0.17862065, -0.25789464, 0.13615008, 0.26929656, 0.67510116, 0.11343988, -0.3122535, 0.45940012, -0.08176509, -0.66644686, 0.041289113, -0.13680273, 0.07486966, -0.0075711305},
			{-0.27771595, 0.014748141, 0.15097937, -0.12333209, -0.55776274, -0.053275343, -0.19260207, -0.45756742, 0.050868776, 0.14478716, 0.009568228, -0.13594034, 0.30457363, 0.5597889, -0.06986807, 0.12210728, 0.25388005, -0.4414696, 0.014585796, 0.102139816, -0.0095526045, 0.33312383, 0.5672383, 0.21701127, -0.096062966, 0.6032682, -0.1704212, 0.14759806, 0.11230577, 0.031450845, -0.038182024, -0.01880728},
			{0.4315791, -1.7553933, -0.010134707, 0.013100914, 0.12378181, -0.058832083, 0.63252944, -0.10610113, -0.026591916, -0.37045357, -6.201665, -0.039602336, -0.11525142, 0.23779483, -1.8899469, -0.002812484, 0.51002485, -0.40988463, -1.8637155, 0.11581475, 0.5624563, -0.29838818, 0.012467152, -0.10798915, 0.4565479, -0.03126065, -0.1286616, 0.75967747, 0.4780635, 0.22687553, -3.6570072, 0.015272862},
			{0.5189207, -0.23999564, -0.24810591, 0.06731672, -1.0672396, 0.034189507, -0.03929697, -1.1736419, -0.10226515, 0.21476173, 0.09938861, -0.5196395, -0.38881835, -0.24239972, 0.42517564, -0.4528924, 0.21478768, -0.47169447, -0.040915173, 0.35503536, 0.2479032, -0.6076843, -0.30304557, -0.23115359, -0.4369185, -1.0668515, 0.5669477, -0.19543831, -0.46520266, 0.04938083, -0.4793912, 0.06642634}};

}
